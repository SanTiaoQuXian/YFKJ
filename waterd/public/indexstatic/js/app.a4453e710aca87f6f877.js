webpackJsonp([13],{IcnI:function(e,n,t){"use strict";var r=t("xd7I"),a=t("2bvH"),o={token:function(e){return e.user.token},avatar:function(e){return e.user.avatar},name:function(e){return e.user.name},wechat:function(e){return e.user.wechat}},u=t("rVsN"),c=t.n(u),i=t("vMJZ"),s=t("TIfe"),f={namespaced:!0,state:{token:Object(s.a)(),name:"",avatar:"",wechat:""},mutations:{SET_TOKEN:function(e,n){e.token=n},SET_NAME:function(e,n){e.name=n},SET_AVATAR:function(e,n){e.avatar=n},SET_WECHAT:function(e,n){e.wechat=n}},actions:{login:function(e,n){var t=e.commit,r=n.username,a=n.password;return new c.a(function(e,n){Object(i.b)({username:r.trim(),password:a}).then(function(n){var r=n;t("SET_TOKEN",r.token),Object(s.c)(r.token),e(r)}).catch(function(e){n(e)})})},getInfo:function(e){var n=e.commit,t=e.state;return new c.a(function(e,r){Object(i.a)(t.token).then(function(t){var a=t;a||r("Verification failed, please Login again.");var o=a.nickname,u=a.avatar,c=a.wechat_code;n("SET_NAME",o),n("SET_AVATAR",u),n("SET_WECHAT",c),e(a)}).catch(function(e){r(e)})})},logout:function(e){var n=e.commit,t=e.state;return new c.a(function(e,r){Object(i.c)(t.token).then(function(){n("SET_TOKEN",""),n("SET_NAME",""),n("SET_AVATAR",""),n("SET_WECHAT",""),Object(s.b)(),e()}).catch(function(e){r(e)})})},resetToken:function(e){var n=e.commit;return new c.a(function(e){n("SET_TOKEN",""),Object(s.b)(),e()})},setWechat:function(e,n){var t=e.commit;return new c.a(function(e){t("SET_WECHAT",n),e()})},setAvatar:function(e,n){var t=e.commit;return new c.a(function(e){t("SET_AVATAR",n),e()})},setName:function(e,n){var t=e.commit;return new c.a(function(e){t("SET_NAME",n),e()})}}};r.default.use(a.a);var l=new a.a.Store({modules:{app:app,user:f},getters:o});n.a=l},"J/rU":function(e,n){},NHnr:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("xd7I"),a={render:function(){var e=this.$createElement,n=this._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},staticRenderFns:[]};var o,u=t("C7Lr")({name:"App"},a,!1,function(e){t("J/rU")},"data-v-1118889c",null).exports,c=t("YaEn"),i=t("IcnI"),s=(t("UYWB"),t("lC5x")),f=t.n(s),l=t("J0Oq"),p=t.n(l),m=t("TIfe"),h=this,d=["/","/login","/register","/rule"];c.a.beforeEach((o=p()(f.a.mark(function e(n,t,r){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(m.a)()){e.next=24;break}if("/login"!==n.path){e.next=6;break}r({path:"/"}),e.next=22;break;case 6:if(!i.a.getters.name){e.next=11;break}r(),e.next=22;break;case 11:return e.prev=11,e.next=14,i.a.dispatch("user/getInfo");case 14:r(),e.next=22;break;case 17:return e.prev=17,e.t0=e.catch(11),e.next=21,i.a.dispatch("user/resetToken");case 21:r("/login?redirect="+n.path);case 22:e.next=25;break;case 24:-1!==d.indexOf(n.path)?r():r("/login?redirect="+n.path);case 25:case"end":return e.stop()}},e,h,[[11,17]])})),function(e,n,t){return o.apply(this,arguments)})),c.a.afterEach(function(){});var v=t("NxjZ"),b=t.n(v);t("zlkP");r.default.config.productionTip=!1,r.default.use(b.a),new r.default({el:"#app",router:c.a,store:i.a,components:{App:u},template:"<App/>"})},TIfe:function(e,n,t){"use strict";n.a=function(){return a.a.get(o)},n.c=function(e){return a.a.set(o,e)},n.b=function(){return a.a.remove(o)};var r=t("sqb0"),a=t.n(r),o="vue_wtree_token"},UYWB:function(e,n){},YaEn:function(e,n,t){"use strict";var r=t("xd7I"),a=t("7LQH");r.default.use(a.a),n.a=new a.a({routes:[{path:"/",name:"Index",component:function(){return Promise.all([t.e(1),t.e(0)]).then(t.bind(null,"JXTs"))}},{path:"/rule",name:"Rule",component:function(){return Promise.all([t.e(2),t.e(0)]).then(t.bind(null,"voyO"))}},{path:"/login",name:"Login",component:function(){return Promise.all([t.e(0),t.e(7)]).then(t.bind(null,"T+/8"))}},{path:"/register",name:"Register",component:function(){return Promise.all([t.e(0),t.e(4)]).then(t.bind(null,"NTb/"))}},{path:"/center",name:"Center",component:function(){return Promise.all([t.e(3),t.e(0)]).then(t.bind(null,"haEB"))}},{path:"/transfer",name:"Transfer",component:function(){return Promise.all([t.e(0),t.e(10)]).then(t.bind(null,"hDl6"))}},{path:"/withdraw",name:"Withdraw",component:function(){return Promise.all([t.e(0),t.e(9)]).then(t.bind(null,"yn+9"))}},{path:"/wechat",name:"Wechat",component:function(){return Promise.all([t.e(0),t.e(6)]).then(t.bind(null,"GcXK"))}},{path:"/invite",name:"Invite",component:function(){return Promise.all([t.e(0),t.e(5)]).then(t.bind(null,"a+HF"))}},{path:"/backup",name:"Backup",component:function(){return Promise.all([t.e(0),t.e(8)]).then(t.bind(null,"eoib"))}},{path:"/notice",name:"Notice",component:function(){return Promise.all([t.e(0),t.e(11)]).then(t.bind(null,"dBZT"))}}]})},vLgD:function(e,n,t){"use strict";var r=t("rVsN"),a=t.n(r),o=t("Muz9"),u=t.n(o),c=t("IcnI"),i=t("YaEn"),s=t("TIfe"),f=t("HzJ8"),l=t.n(f),p=t("mgIi"),m=t.n(p);var h=t("NxjZ"),d=u.a.create({baseURL:"api",withCredentials:!0,timeout:5e3});d.interceptors.request.use(function(e){return c.a.getters.token&&(e.headers.token=Object(s.a)()),e.headers.sign=function(e){var n="",t=[];e.params?t=e.params:e.data&&(t=e.data);var r=[];for(var a in t)r.push(a);var o=r.sort(),u=!0,c=!1,i=void 0;try{for(var s,f=l()(o);!(u=(s=f.next()).done);u=!0){var p=s.value;n+=p+"="+t[p]+"&"}}catch(e){c=!0,i=e}finally{try{!u&&f.return&&f.return()}finally{if(c)throw i}}return n=n.slice(0,-1),m.a.HmacSHA256(n,"wtreeappkey").toString()}(e),e},function(e){return console.log(e),a.a.reject(e)}),d.interceptors.response.use(function(e){var n=e.data;return n?0===n.status?a.a.reject(new Error(n.msg||"Error")):n.status>1e4&&n.status<2e4?(c.a.dispatch("user/resetToken").then(function(){i.a.replace({path:"/login",query:{redirect:i.a.currentRoute.fullPath}})}),a.a.reject(new Error("登录失效"))):20001===n.status?a.a.reject():30002===n.status?(Object(h.Message)({message:n.msg,type:"error"}),a.a.reject()):1===n.status?n.data:a.a.reject(new Error("debug:"+n)):a.a.reject(new Error("nothing"))},function(e){return console.log("err"+e),a.a.reject(e)});n.a=d},vMJZ:function(e,n,t){"use strict";n.d=function(e){return Object(r.a)({url:"/user/register",method:"post",data:e})},n.b=function(e){return Object(r.a)({url:"/user/login",method:"post",data:e})},n.a=function(e){return Object(r.a)({url:"/user/authInfo",method:"get",params:{token:e}})},n.c=function(){return Object(r.a)({url:"/user/logout",method:"post"})};var r=t("vLgD")},zlkP:function(e,n){}},["NHnr"]);
//# sourceMappingURL=app.a4453e710aca87f6f877.js.map